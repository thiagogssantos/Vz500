
[mcu]
serial: /dev/serial/by-id/usb-Klipper_stm32h723xx_10001B001051313236343430-if00
#####################################################################
# 	Macros
#####################################################################
[include EBB.cfg]
#[include OrbiterSensor.cfg]
[include mainsail.cfg]
[include Macros.cfg]
[include MacrosMass.cfg]
[include SpeedTest.cfg]
[include klicky-probe.cfg]

[include mmu/base/*.cfg]
[include mmu/addons/blobifier.cfg]
[include mmu/optional/mmu_menu.cfg]
[include mmu/optional/client_macros.cfg]

[exclude_object]
[gcode_arcs]
resolution: 0.5

[endstop_phase]
[pause_resume]
[respond]

[include ADXL345_EBB.cfg]
#[include ADXL345.cfg]
#[include ADXL345B.cfg]

[virtual_sdcard]
path: /home/biqu/printer_data/gcodes

[idle_timeout]
timeout: 72000


#####################################################################
# 	XY Stepper Settings
#####################################################################

[stepper_x] #driver0
step_pin: PF13
dir_pin: PF12
enable_pin: !PF14
microsteps: 16
rotation_distance: 40
full_steps_per_rotation: 200  
endstop_pin: !EBBCan:PB8
position_endstop: 0
position_min: 0
position_max: 510
homing_speed: 50

[tmc5160 stepper_x]
#uart_pin: PC4
cs_pin: PC4
spi_bus: spi1
diag1_pin: PG6
sense_resistor: 0.075
run_current: 1.2
interpolate: True #False


[stepper_x1] #driver1
step_pin: PG0
dir_pin: PG1
enable_pin: !PF15
microsteps: 16
rotation_distance: 40
full_steps_per_rotation: 200  


[tmc5160 stepper_x1]
#uart_pin: PD11
cs_pin: PD11
spi_bus: spi1
sense_resistor: 0.075
run_current: 1.2
interpolate: True #False


[stepper_y] #driver6
step_pin: PE2
dir_pin: PE3
enable_pin: !PD4
microsteps: 16
rotation_distance: 40
full_steps_per_rotation: 200
endstop_pin: !PG9
position_min: 0
position_max: 527
position_endstop: 0
homing_speed: 50


[tmc5160 stepper_y] 
cs_pin: PE1
spi_bus: spi1
sense_resistor: 0.075
run_current: 1.2
interpolate: True #False


[stepper_y1] #driver7
step_pin: PE6
dir_pin:PA14
enable_pin: !PE0
microsteps: 16
rotation_distance: 40
full_steps_per_rotation: 200  


[tmc5160 stepper_y1] 
cs_pin: PD3
spi_bus: spi1
sense_resistor: 0.075
run_current: 1.2
interpolate: True #False


[autotune_tmc stepper_x]
motor: ldo-42sth48-2504ac
#tuning_goal: silent
voltage: 24
[autotune_tmc stepper_x1]
motor: ldo-42sth48-2504ac
#tuning_goal: silent
voltage: 24
[autotune_tmc stepper_y]
motor: ldo-42sth48-2504ac
#tuning_goal: silent
voltage: 24
[autotune_tmc stepper_y1]
motor: ldo-42sth48-2504ac
#tuning_goal: silent
voltage: 24

[autotune_tmc extruder]
motor: ldo-36sth20-1004ahg
tuning_goal: performance

[autotune_tmc stepper_z]
motor: hangpose-17hs4401
tuning_goal: performance

[autotune_tmc stepper_z1]
motor: hangpose-17hs4401
tuning_goal: performance

[autotune_tmc stepper_z2]
motor: hangpose-17hs4401
tuning_goal: performance

[autotune_tmc stepper_z3]
motor: hangpose-17hs4401
tuning_goal: performance


#####################################################################
# 	Z Stepper Settings
#####################################################################

[stepper_z] #driver2
step_pin: PF11
dir_pin: PG3
enable_pin: !PG5
microsteps: 16
rotation_distance: 4
endstop_pin: probe:z_virtual_endstop
#endstop_pin: PG10
#position_endstop: -0.770
position_max: 510
position_min: -5

[tmc2209 stepper_z]
uart_pin: PC6
sense_resistor: 0.110
run_current: 0.8
#stealthchop_threshold: 99999
interpolate: True #false

[stepper_z1] #driver3
step_pin: PG4
dir_pin: PC1
enable_pin: !PA2
microsteps: 16
rotation_distance: 4

[tmc2209 stepper_z1]
uart_pin: PC7
sense_resistor: 0.110
run_current: 0.8
#stealthchop_threshold: 99999
interpolate: True #false

[stepper_z2] #driver4
step_pin: PF9
dir_pin: PF10
enable_pin: !PG2
microsteps: 16
rotation_distance: 4

[tmc2209 stepper_z2]
uart_pin: PF2
sense_resistor: 0.110
run_current: 0.8
#stealthchop_threshold: 99999
interpolate: True #false

[stepper_z3] #driver5
step_pin: PC13
dir_pin: PF0
enable_pin: !PF1
microsteps: 16
rotation_distance: 4

[tmc2209 stepper_z3]
uart_pin: PE4
sense_resistor: 0.110
run_current: 0.8
#stealthchop_threshold: 99999
interpolate: True #false


#[safe_z_home]
#home_xy_position: 250,522.5 # Change coordinates to the center of your print bed
#speed: 200
#z_hop: 20
#z_hop_speed: 15

#[z_calibration]
#nozzle_xy_position: 251,522  #<X,Y position for clicking the nozzle on the z endstop - not needed if [safe_z_home] is used>
#switch_xy_offsets:  0,-21.5    #<X,Y offsets from the nozzle position for clicking the probe's switch body on the z endstop>
#bed_xy_position: 250,250       #<X,Y position for probing the bed, for instance the center point - not needed if mesh with zero_reference_position is used>
#switch_offset: 0.39            #<offset of the switch trigger (read the Switch Offset section!)>
#start_gcode: ATTACH_PROBE      #<macro name for attaching the probe>
#before_switch_gcode:          #<macro name for attaching the probe AFTER probing the nozzle>
#end_gcode: DOCK_PROBE          #<macro name for docking the probe>


[quad_gantry_level]

gantry_corners: -25, 24.5
                530, 456.5

points: 40,42.5 #60,42.5
        40,462.5
        480,462.5
        480,42.5
 
speed: 500
horizontal_move_z: 15
retries: 10
retry_tolerance: 0.01
max_adjust: 15

#####################################################################
# 	Probe
#####################################################################

[probe]
pin: ^EBBCan:PB9
x_offset: 0
y_offset: 17.5 #18.3
#z_offset: 8
speed: 10
samples: 3
sample_retract_dist: 1
samples_tolerance_retries: 3
#samples_result: median


[bed_mesh]
zero_reference_position: 250,250
adaptive_margin: 10
algorithm: bicubic
bicubic_tension: 0.1
speed: 150
horizontal_move_z: 11
mesh_min: 20,20
mesh_max: 480,480
probe_count: 19,19
mesh_pps: 2,2
move_check_distance: 5
split_delta_z: 0.025
fade_start: 2
fade_end: 22

#fade_target: 0


#####################################################################
# 	Extruder
#####################################################################

#EBB

#####################################################################
# 	Bed Heater
#####################################################################

[heater_bed]
heater_pin: PA1
sensor_pin: PF3 # TB
sensor_type: EPCOS 100K B57560G104F
max_power: 0.5
min_temp: 0
max_temp: 120
pwm_cycle_time: 0.0166

control: pid #60 @50%
pid_kp: 31.723
pid_ki: 0.499
pid_kd: 504.389

#control: pid #75 @50%
#pid_kp: 33.739
#pid_ki: 0.650
#pid_kd: 437.767

#control: pid #105
#pid_kp: 35.307
#pid_ki: 0.923
#pid_kd: 337.626


[verify_heater heater_bed]
check_gain_time: 180
heating_gain: 0.5


#####################################################################
# 	Fan Control
#####################################################################

[fan]
pin: PA8
max_power: 0.8
shutdown_speed: 0
cycle_time: 0.005
hardware_pwm: False
kick_start_time: 0.100
off_below: 0.1


#[heater_fan nozzle_cooling_fan]
#pin: PE5

[multi_pin RSCS]
pins: PE5, PD12

[fan_generic RSCS]
pin: multi_pin:RSCS


[temperature_fan Chamber]
pin: PD13
kick_start_time: 0.0
shutdown_speed: 0.0
off_below: 0.1
max_power: 1.0
sensor_type: EPCOS 100K B57560G104F
sensor_pin: PF6
control: pid
min_temp: 0
max_temp: 85
pid_kp: 30.0
pid_ki: 1.0
pid_kd: 175.0
pid_deriv_time: 1.0
min_speed: 0.0
max_speed: 1.0
gcode_id: CHAMBER_TEMP

#[fan4]
#pin: PD14

[multi_pin Octopus_fan]
pins: PD14, PD15

[temperature_fan Octopus]
pin: multi_pin:Octopus_fan
max_power: 1.0
min_temp: 0
max_temp: 100
kick_start_time: 0.5
off_below: 0.1
sensor_type: temperature_mcu
control: pid
pid_kp: 2.0
pid_ki: 1.0
pid_kd: 35.0
pid_deriv_time: 1.0
min_speed: 0.0
max_speed: 1.0
target_temp: 38

#[temperature_fan Drivers]
#pin: PD14
#max_power: 1.0
#min_temp: 0
#max_temp: 100
#kick_start_time: 0.5
#off_below: 0.1
#sensor_pin: PF7 # T3
#sensor_type: EPCOS 100K B57560G104F
#control: pid
#pid_kp: 2.0
#pid_ki: 1.0
#pid_kd: 35.0
#pid_deriv_time: 1.0
#min_speed: 0.15
#max_speed: 1.0
#target_temp: 40


#####################################################################
# 	Temperature Sensors
#####################################################################

#[temperature_sensor Octopus]
#sensor_type: temperature_mcu
#min_temp: 0
#max_temp: 100

[temperature_sensor Bed_2]
sensor_pin: PF4 # T0
sensor_type: EPCOS 100K B57560G104F
min_temp: -200
max_temp: 120

[temperature_sensor Chamber_mid]
sensor_pin: PF5 # T1
sensor_type: EPCOS 100K B57560G104F
min_temp: -200
max_temp: 100

[temperature_sensor Drivers]
sensor_pin: PF7 # T3
sensor_type: EPCOS 100K B57560G104F
min_temp: -200
max_temp: 100

[temperature_sensor BBT-PI]
sensor_type: temperature_host

#####################################################################
# Kinematics Settings
#####################################################################

[printer]
kinematics: corexy
max_velocity: 500
max_accel: 10000
#max_accel_to_decel: 3000
max_z_velocity: 30
max_z_accel: 1000
square_corner_velocity: 5

#####################################################################
# EXP1 / EXP2 (display) pins
#####################################################################

[board_pins]
aliases:
    # EXP1 header
    EXP1_1=PE8, EXP1_2=PE7,
    EXP1_3=PE9, EXP1_4=PE10,
    EXP1_5=PE12, EXP1_6=PE13,    # Slot in the socket on this side
    EXP1_7=PE14, EXP1_8=PE15,
    EXP1_9=<GND>, EXP1_10=<5V>,

    # EXP2 header
    EXP2_1=PA6, EXP2_2=PA5,
    EXP2_3=PB1, EXP2_4=PA4,
    EXP2_5=PB2, EXP2_6=PA7,      # Slot in the socket on this side
    EXP2_7=PC15, EXP2_8=<RST>,
    EXP2_9=<GND>, EXP2_10=PC5

[display]
lcd_type: uc1701
cs_pin: EXP1_3
a0_pin: EXP1_4
rst_pin: EXP1_5
contrast: 63
encoder_pins: ^EXP2_5, ^EXP2_3
click_pin: ^!EXP1_2
spi_bus: spi1

[pwm_cycle_time beeper]
pin: EXP1_1
value: 0
shutdown_value: 0
cycle_time: 0.0005 ; Default beeper tone in kHz. 1 / 0.0005 = 2000Hz (2kHz)

[neopixel btt_mini12864]
pin: EXP1_6
chain_count: 4
color_order: RGBW
initial_RED: 0.4
initial_GREEN: 0.4
initial_BLUE: 0.4
initial_WHITE: 0.7    

#####################################################################
# Extra pins
#####################################################################

#[neopixel my_neopixel]
#pin: PB10

#*# <---------------------- SAVE_CONFIG ---------------------->
#*# DO NOT EDIT THIS BLOCK OR BELOW. The contents are auto-generated.
#*#
#*# [probe]
#*# z_offset = 7.450
#*#
#*# [bed_mesh default25]
#*# version = 1
#*# points =
#*# 	-0.060052, -0.028333, -0.004896, 0.018229, 0.028542, 0.038490, 0.041979, 0.039375, 0.027813, 0.024792, 0.022813, 0.020469, 0.009063, -0.002760, -0.015156, -0.027240, -0.052448
#*# 	-0.060208, -0.028646, -0.003698, 0.020052, 0.026146, 0.032813, 0.042135, 0.050104, 0.046094, 0.045365, 0.045885, 0.040677, 0.033438, 0.020990, 0.012292, -0.005573, -0.033802
#*# 	-0.079687, -0.043385, -0.020260, 0.003333, 0.012813, 0.019635, 0.029167, 0.032344, 0.033906, 0.038073, 0.044010, 0.040885, 0.035938, 0.026510, 0.019896, 0.002708, -0.026094
#*# 	-0.096927, -0.056354, -0.029635, -0.005625, 0.007865, 0.013021, 0.020208, 0.029063, 0.033854, 0.036146, 0.042552, 0.037135, 0.040208, 0.036823, 0.031563, 0.016146, -0.017396
#*# 	-0.111823, -0.068542, -0.039635, -0.018021, -0.002396, 0.003229, 0.003229, 0.017135, 0.015417, 0.016979, 0.032396, 0.037292, 0.035521, 0.040313, 0.027500, 0.007865, -0.019010
#*# 	-0.122656, -0.078698, -0.042656, -0.017344, -0.000417, 0.005000, 0.004063, 0.004063, 0.003073, 0.004688, 0.023646, 0.032344, 0.036198, 0.036875, 0.025052, 0.008281, -0.023125
#*# 	-0.131302, -0.089583, -0.048958, -0.018594, -0.001823, 0.005938, 0.003906, 0.002708, -0.000521, 0.006823, 0.026875, 0.036979, 0.037396, 0.032656, 0.022969, 0.001771, -0.031667
#*# 	-0.139687, -0.088594, -0.050260, -0.024479, -0.006042, 0.000677, 0.001302, 0.002656, -0.004844, 0.004010, 0.022292, 0.033333, 0.034271, 0.025000, 0.013021, -0.009792, -0.043385
#*# 	-0.147917, -0.098750, -0.056094, -0.026823, -0.005521, 0.006458, 0.008229, 0.007813, 0.000000, 0.002396, 0.019375, 0.030677, 0.026771, 0.021562, -0.002969, -0.023073, -0.054531
#*# 	-0.146563, -0.101667, -0.059479, -0.026250, -0.007083, 0.012552, 0.016562, 0.016146, 0.013750, 0.015104, 0.028333, 0.031354, 0.023802, 0.006146, -0.017344, -0.038281, -0.065781
#*# 	-0.141875, -0.093750, -0.059010, -0.024635, -0.000677, 0.018750, 0.029010, 0.030469, 0.024583, 0.023958, 0.032448, 0.030937, 0.017604, -0.005417, -0.029427, -0.047396, -0.070885
#*# 	-0.139167, -0.090521, -0.051042, -0.015417, 0.014115, 0.032135, 0.042344, 0.049062, 0.046719, 0.045781, 0.045312, 0.032969, 0.013542, -0.010417, -0.033438, -0.053125, -0.077969
#*# 	-0.122448, -0.073802, -0.037813, -0.005938, 0.022865, 0.039115, 0.056927, 0.068750, 0.069635, 0.064844, 0.063385, 0.046667, 0.023125, -0.001719, -0.026823, -0.048073, -0.071979
#*# 	-0.106615, -0.064844, -0.025833, 0.005417, 0.032448, 0.050729, 0.070833, 0.089844, 0.090729, 0.089740, 0.080833, 0.062187, 0.039062, 0.006823, -0.019635, -0.044844, -0.063490
#*# 	-0.087552, -0.040469, -0.006771, 0.025000, 0.054687, 0.075417, 0.097865, 0.117083, 0.123021, 0.120781, 0.112812, 0.089115, 0.060573, 0.024427, -0.010417, -0.036615, -0.062865
#*# 	-0.077135, -0.028385, 0.008594, 0.039896, 0.061719, 0.089167, 0.117448, 0.137083, 0.138958, 0.139531, 0.130937, 0.108594, 0.070937, 0.036302, -0.000104, -0.028594, -0.052500
#*# 	-0.060885, -0.010625, 0.025677, 0.055365, 0.078490, 0.105781, 0.134687, 0.155000, 0.165521, 0.163698, 0.156042, 0.126458, 0.088125, 0.047396, 0.011198, -0.024271, -0.054427
#*# x_count = 17
#*# y_count = 17
#*# mesh_x_pps = 3
#*# mesh_y_pps = 3
#*# algo = bicubic
#*# tension = 0.2
#*# min_x = 20.0
#*# max_x = 480.0
#*# min_y = 20.0
#*# max_y = 480.0
#*#
#*# [bed_mesh default65]
#*# version = 1
#*# points =
#*# 	  0.069472, 0.066555, 0.086972, 0.034055, 0.004889, -0.000111, -0.013861, -0.032195, -0.050528, -0.066778, -0.058445, -0.037611, -0.020528, -0.008861, 0.009055, 0.031139, 0.037389, 0.048639, 0.061555
#*# 	  0.055722, 0.034055, 0.021972, -0.006778, -0.034695, -0.039278, -0.043861, -0.052195, -0.061361, -0.055111, -0.048445, -0.028028, -0.010528, 0.007389, 0.028222, 0.033639, 0.040305, 0.055305, 0.074472
#*# 	  0.032805, 0.002805, 0.009055, -0.038861, -0.050528, -0.057195, -0.060528, -0.055528, -0.042195, -0.048861, -0.035528, -0.020528, -0.012195, 0.006139, 0.028639, 0.035722, 0.039055, 0.063222, 0.078222
#*# 	  0.013639, -0.013861, -0.013445, -0.048028, -0.048445, -0.054278, -0.055528, -0.048861, -0.041361, -0.036778, -0.026361, -0.009278, 0.001555, 0.009055, 0.019889, 0.033222, 0.047389, 0.063222, 0.070305
#*# 	  -0.009278, -0.040528, -0.056361, -0.068445, -0.058445, -0.068445, -0.066778, -0.043861, -0.034695, -0.032611, -0.020945, 0.001555, 0.011139, 0.016139, 0.030722, 0.039055, 0.049889, 0.066555, 0.069472
#*# 	  -0.023445, -0.047195, -0.058445, -0.074278, -0.063028, -0.060945, -0.044278, -0.027195, -0.033028, -0.023028, -0.015528, -0.004278, 0.014889, 0.011972, 0.026555, 0.032389, 0.038639, 0.050722, 0.058222
#*# 	  -0.034695, -0.048028, -0.073028, -0.090111, -0.080111, -0.062611, -0.063445, -0.047611, -0.016361, -0.011361, -0.006778, 0.006555, 0.039055, 0.023222, 0.029889, 0.031972, 0.032805, 0.045722, 0.051972
#*# 	  -0.025528, -0.059278, -0.068028, -0.074278, -0.091361, -0.068861, -0.051361, -0.038028, -0.026778, -0.009278, -0.004278, 0.000305, 0.018222, 0.018222, 0.011139, 0.014055, 0.026555, 0.036139, 0.044055
#*# 	  -0.026778, -0.058861, -0.074695, -0.074695, -0.073445, -0.072195, -0.063028, -0.033861, -0.025111, -0.013445, -0.001778, 0.011139, 0.036972, 0.018639, 0.018222, 0.018639, 0.029472, 0.053222, 0.048639
#*# 	  -0.009278, -0.042611, -0.063445, -0.066361, -0.069278, -0.076778, -0.055945, -0.026361, -0.004695, 0.000305, 0.009472, 0.021972, 0.019472, 0.009055, 0.015722, 0.021555, 0.025305, 0.051139, 0.059055
#*# 	  0.014472, -0.031361, -0.043028, -0.061778, -0.066778, -0.062611, -0.046361, -0.028028, -0.015945, 0.011139, 0.008222, 0.019055, 0.018639, 0.015305, 0.017389, 0.022389, 0.029889, 0.064889, 0.082389
#*# 	  0.062389, 0.015722, -0.017195, -0.018445, -0.028028, -0.033028, -0.030111, -0.011361, -0.010945, -0.000528, 0.010722, 0.015305, 0.019472, 0.025305, 0.026972, 0.032389, 0.044889, 0.067805, 0.085305
#*# 	  0.086139, 0.038222, 0.000722, -0.014695, -0.005945, -0.019278, -0.018861, -0.001361, 0.022805, 0.024472, 0.004472, 0.024055, 0.048222, 0.053222, 0.045722, 0.056139, 0.061555, 0.067389, 0.098639
#*# 	  0.084889, 0.045305, 0.041972, -0.007195, 0.004055, 0.001972, 0.001972, 0.006972, 0.049055, 0.064889, 0.027805, 0.032389, 0.067389, 0.055305, 0.046139, 0.061139, 0.066972, 0.084889, 0.131139
#*# 	  0.101139, 0.053639, 0.051555, 0.047389, 0.049472, 0.042389, 0.006139, 0.025305, 0.056972, 0.081139, 0.051139, 0.043222, 0.070305, 0.079055, 0.056555, 0.074472, 0.078639, 0.081139, 0.141555
#*# 	  0.091139, 0.067805, 0.049055, 0.060305, 0.063639, 0.053222, 0.036972, 0.031972, 0.032805, 0.050722, 0.059055, 0.063222, 0.073639, 0.087389, 0.086555, 0.086555, 0.081972, 0.101555, 0.147389
#*# 	  0.113222, 0.067389, 0.067805, 0.052389, 0.047805, 0.036972, 0.031139, 0.022805, 0.024055, 0.036555, 0.058639, 0.084055, 0.088639, 0.104472, 0.115305, 0.109472, 0.097389, 0.104889, 0.137389
#*# 	  0.119889, 0.073222, 0.074472, 0.061555, 0.059889, 0.039472, 0.040722, 0.068639, 0.043222, 0.053222, 0.064055, 0.098639, 0.118222, 0.121139, 0.136972, 0.129055, 0.119055, 0.114472, 0.119055
#*# 	  0.124472, 0.093639, 0.121972, 0.113222, 0.101139, 0.074889, 0.072805, 0.076555, 0.079055, 0.090722, 0.108222, 0.129472, 0.132389, 0.137389, 0.141139, 0.141139, 0.128222, 0.116555, 0.125722
#*# min_x = 21.0
#*# max_x = 480.0
#*# min_y = 21.0
#*# max_y = 480.0
#*# x_count = 19
#*# y_count = 19
#*# mesh_x_pps = 2
#*# mesh_y_pps = 2
#*# algo = bicubic
#*# tension = 0.1
